<?php
//require_once '../library/Dialer/Dialer.php';
//echo __DIR__;
//require_once '//dialer/dialer.php';
//$incoming = api_ajax("incoming");
//$outgoing = api_ajax("outgoing");
//$agents = api_ajax("agents");
//$inbound_activity = api_ajax("inbound_activity");

?>

<br>
<div class="container-fluid">
  <h2 class="p-0 m-0"><span>Collector Board</span></h2>
    <div class="row">
        <div class="col-5">
            <div class="card game">
            						<h5 class="card-header">
            							<a>Feed
            							</a>
            						</h5>
            						<div id="feed">
            							<div class="card-body game">

            								<div class="page-wrapper">
            								  <div id="feed" class="feed">
            										<div class="item shadow"><span class="user"><img width="50px" height="50px" class="img-circle" src="/uploads/39-70-15-73.png" alt="User Avatar" onerror="this.onerror=null;this.src='uploads/default.png'"></span><div class="meta "><div class=""><h5 style="margin-bottom: 0px;">Helen Bingley</h5><p style="margin-top: 0px; color: grey;">just now</p></div><div class="post-message"><p>Gained 1% Accounts Worked Well Done! </p></div></div></div><div class="item shadow"><span class="user"><img width="50px" height="50px" class="img-circle" src="/uploads/20-83-31-85.png" alt="User Avatar" onerror="this.onerror=null;this.src='uploads/default.png'"></span><div class="meta "><div class=""><h5 style="margin-bottom: 0px;">Robson Baines</h5><p style="margin-top: 0px; color: grey;">just now</p></div><div class="post-message"><p>Gained 1% Arrangements To Target Well Done! </p></div></div></div><div class="item shadow"><span class="user"><img width="50px" height="50px" class="img-circle" src="/uploads/51-54-11-75.png" alt="User Avatar" onerror="this.onerror=null;this.src='uploads/default.png'"></span><div class="meta "><div class=""><h5 style="margin-bottom: 0px;">Isabel Hartley</h5><p style="margin-top: 0px; color: grey;">2 minutes ago</p></div><div class="post-message"><p>Gained 1% Accounts Worked Well Done! </p></div></div></div><div class="item shadow"><span class="user"><img width="50px" height="50px" class="img-circle" src="uploads/default.png" alt="User Avatar" onerror="this.onerror=null;this.src='uploads/default.png'"></span><div class="meta "><div class=""><h5 style="margin-bottom: 0px;">Lauren Arafat</h5><p style="margin-top: 0px; color: grey;">4 minutes ago</p></div><div class="post-message"><p>Gained 1% Accounts Worked Well Done! </p></div></div></div><div class="item shadow"><span class="user"><img width="50px" height="50px" class="img-circle" src="/uploads/51-54-11-75.png" alt="User Avatar" onerror="this.onerror=null;this.src='uploads/default.png'"></span><div class="meta "><div class=""><h5 style="margin-bottom: 0px;">Isabel Hartley</h5><p style="margin-top: 0px; color: grey;">10 minutes ago</p></div><div class="post-message"><p>Gained 1% Revenue To Target Well Done! </p></div></div></div><div class="item shadow"><span class="user"><img width="50px" height="50px" class="img-circle" src="/uploads/20-83-31-85.png" alt="User Avatar" onerror="this.onerror=null;this.src='uploads/default.png'"></span><div class="meta "><div class=""><h5 style="margin-bottom: 0px;">Robson Baines</h5><p style="margin-top: 0px; color: grey;">10 minutes ago</p></div><div class="post-message"><p>Gained 1% Revenue To Target Well Done! </p></div></div></div><div class="item shadow"><span class="user"><img width="50px" height="50px" class="img-circle" src="uploads/default.png" alt="User Avatar" onerror="this.onerror=null;this.src='uploads/default.png'"></span><div class="meta "><div class=""><h5 style="margin-bottom: 0px;">Rhys Langton</h5><p style="margin-top: 0px; color: grey;">10 minutes ago</p></div><div class="post-message"><p>Gained 1% Accounts Worked Well Done! </p></div></div></div><div class="item shadow"><span class="user"><img width="50px" height="50px" class="img-circle" src="/uploads/51-54-11-75.png" alt="User Avatar" onerror="this.onerror=null;this.src='uploads/default.png'"></span><div class="meta "><div class=""><h5 style="margin-bottom: 0px;">Isabel Hartley</h5><p style="margin-top: 0px; color: grey;">12 minutes ago</p></div><div class="post-message"><p>Gained 1% Accounts Worked Well Done! </p></div></div></div><div class="item shadow"><span class="user"><img width="50px" height="50px" class="img-circle" src="/uploads/51-54-11-75.png" alt="User Avatar" onerror="this.onerror=null;this.src='uploads/default.png'"></span><div class="meta "><div class=""><h5 style="margin-bottom: 0px;">Isabel Hartley</h5><p style="margin-top: 0px; color: grey;">12 minutes ago</p></div><div class="post-message"><p>Gained 1% Arrangements To Target Well Done! </p></div></div></div><div class="item shadow"><span class="user"><img width="50px" height="50px" class="img-circle" src="/uploads/51-54-11-75.png" alt="User Avatar" onerror="this.onerror=null;this.src='uploads/default.png'"></span><div class="meta "><div class=""><h5 style="margin-bottom: 0px;">Isabel Hartley</h5><p style="margin-top: 0px; color: grey;">12 minutes ago</p></div><div class="post-message"><p>Gained 1% Arrangements To Target Well Done! </p></div></div></div>								    <!-- <div class="item">
            								      <div class="user"></div>
            								      <div class="meta">
            								        <h5>Superman</h5>
            								        <p>Just owned Batman...</p>
            								      </div>
            								      <div class="reward">&times;</div>
            								    </div> -->

            								  </div>
            								</div>

            							</div>
            						</div>
            					</div>
                </div>
                <div class="col-7">


                    <div class="card game">
							<h5 class="card-header game collections-style" role="tab" id="awards-header">
									<a class="collapsed d-block">
											Collections
									</a>
							</h5>
							<div id="awards">
									<div class="card-body game">
										<div class="container pt-3">
										<div class="row collections">

											<div class="col-4 col-md-4 awards-boxes"><div class="h-100 award-box p-3 shadow"><h5>Kiran Qureshi </h5><p>Most payment arrangements across business (yesterday)
</p><p>Well Done Kiran!</p><span><i class="fas fa-thumbs-up"></i></span></div></div><div class="col-4 col-md-4 awards-boxes"><div class="h-100 award-box p-3 shadow"><h5>Scott Martin </h5><p>Most revenue across business (yesterday) Most  %

</p><p>Well Done Scott!</p><span><i class="fas fa-thumbs-up"></i></span></div></div><div class="col-4 col-md-4 awards-boxes"><div class="h-100 award-box p-3 shadow"><h5>Rhys Langton </h5><p>Most accounts worked across business (yesterday)
</p><p>Well Done Rhys!</p><span><i class="fas fa-thumbs-up"></i></span></div></div>										</div>
									</div>
									</div>
							</div>
					</div>
                    <div class="card game ">
							<h5 class="card-header game WL-style" role="tab" id="awards-header">
									<a class="collapsed d-block">
											White Label/Utilities
									</a>
							</h5>
							<div id="awards">
									<div class="card-body game">
										<div class="container pt-3">
										<div class="row WL">

											<div class="col-4 col-md-4 awards-boxes"><div class="h-100 award-box p-3 shadow"><h5>Kiran Qureshi </h5><p>Most payment arrangements across business (yesterday)
</p><p>Well Done Kiran!</p><span><i class="fas fa-thumbs-up"></i></span></div></div><div class="col-4 col-md-4 awards-boxes"><div class="h-100 award-box p-3 shadow"><h5>Scott Martin </h5><p>Most revenue across business (yesterday) Most  % to Target
</p><p>Well Done Scott!</p><span><i class="fas fa-thumbs-up"></i></span></div></div><div class="col-4 col-md-4 awards-boxes"><div class="h-100 award-box p-3 shadow"><h5>Rhys Langton </h5><p>Most accounts worked across business (yesterday)
</p><p>Well Done Rhys!</p><span><i class="fas fa-thumbs-up"></i></span></div></div>										</div>
									</div>
									</div>
							</div>
					</div>
                    <div class="card game">
							<h5 class="card-header game legal-style" role="tab" id="awards-header">
									<a class="collapsed d-block">
											Legal
									</a>
							</h5>
							<div id="awards">
									<div class="card-body game">
										<div class="container pt-3">
										<div class="row legal">

											<div class="col-4 col-md-4 awards-boxes"><div class="h-100 award-box p-3 shadow"><h5>Kiran Qureshi </h5><p>Most payment arrangements across business (yesterday)
</p><p>Well Done Kiran!</p><span><i class="fas fa-thumbs-up"></i></span></div></div><div class="col-4 col-md-4 awards-boxes"><div class="h-100 award-box p-3 shadow"><h5>Scott Martin </h5><p>Most revenue across business (yesterday) Most  % to Target
</p><p>Well Done Scott!</p><span><i class="fas fa-thumbs-up"></i></span></div></div><div class="col-4 col-md-4 awards-boxes"><div class="h-100 award-box p-3 shadow"><h5>Rhys Langton </h5><p>Most accounts worked across business (yesterday)
</p><p>Well Done Rhys!</p><span><i class="fas fa-thumbs-up"></i></span></div></div>										</div>
									</div>
									</div>
							</div>
					</div>



                </div>
            </div>
</div>
<div class="container-fluid">
        <div class="row ticker-wrap ticker-tobottom ">
            <div class="ticker" id='ticker'>

            </div>
        </div>
</div>

<script>
function updateTicker(){

				$('.ticker').empty();
				var ticker_info='';
				var opJSON=

                $.ajax({
                  url: '/admin/gameinfo',
                  dataType: 'json',
                  async: false,
                  cache: true,
                  success: function(data) {
                      $.each(data, function(op_code, val){
                          if (data[op_code]['avatar_file']) { ava = data[op_code]['avatar_file']; } else { ava = 'default'; }
                          ticker_info = '<div class="ticker__item"><div class="row"><div class="col-4"><span><img width="100px" height="100px" class="img-circle-bg" src="http://mygame.halifax.creditresourcesolutions.co.uk//uploads/'+ava+'.png" alt="User Avatar"></span></div><div class="col-8" style="padding-top: 16px;">					<strong>'+data[op_code]['name']+'<br>	 - 	</strong>		 <strong>Level:	</strong>'+data[op_code]['level']+'		 <strong>Prestige: </strong>'+data[op_code]['prestige']+'					</div></div></div>';
                          $('.ticker').append(ticker_info);
                      })
                  }
                });


}
function updateFeed(){
				$('.feed').empty();
				var feed_info='';
                var count = 0;
				var opJSON=

                $.ajax({
                  url: '/admin/gameinfo',
                  dataType: 'json',
                  async: false,
                  success: function(data) {
                      $.each(data, function(op_code, val){
                          if(count!=6){
                              var str = data[op_code]['latestAchievement'];

                              if(str.includes("%")){
                                var latestAchievement = str.split("%");
                  				if (data[op_code]['avatar_file']) { ava = data[op_code]['avatar_file']; } else { ava = 'default'; }
                                  feed_info = '<div class="item shadow"><span class="user"><img width="50px" height="50px" class="img-circle" src="http://mygame.halifax.creditresourcesolutions.co.uk//uploads/'+ava+'.png" alt="User Avatar"></span><div class="meta "><div class=""><h5 style="margin-bottom: 0px;">'+data[op_code]['name']+'</h5><p style="margin-top: 0px; color: grey;">'+data[op_code]['time_latestAchievement']+'</p></div><div class="post-message"><p>Gained '+data[op_code]['accumulated_latestAchievement_Percent']+'% '+latestAchievement[1]+'</p></div></div></div>'

                                  $('.feed').append(feed_info);
                                  count+=1;
                              }
                              else{
                                  if (data[op_code]['avatar_file']) { ava = data[op_code]['avatar_file']; } else { ava = 'default'; }
                                    feed_info = '<div class="item shadow"><span class="user"><img width="50px" height="50px" class="img-circle" src="http://mygame.halifax.creditresourcesolutions.co.uk//uploads/'+ava+'.png" alt="User Avatar"></span><div class="meta "><div class=""><h5 style="margin-bottom: 0px;">'+data[op_code]['name']+'</h5><p style="margin-top: 0px; color: grey;">'+data[op_code]['time_latestAchievement']+'</p></div><div class="post-message"><p>'+str+'</p></div></div></div>'

                                    $('.feed').append(feed_info);
                                    count+=1;

                              }
                          }
      				})
                  }
                });
}
function updateMosts(){
                $('.WL').empty();
                $('.collections').empty();
                $('.legal').empty();
				var award='';
				var opJSON=

                $.ajax({
                  url: '/admin/gamemosts',
                  dataType: 'json',
                  async: false,
                  success: function(data) {
                      $.each(data, function(sector, jobs){
                          $.each(jobs, function(job, operator){
                              var opname = operator['name'];
                              var firstName = opname.split(" ");
                              if(job == 'accounts_worked'){
                                  award='<div class="col-4 col-md-4 awards-boxes"><div class="h-100 award-box shadow" ><p>'+operator['name']+'</p><p>Most accounts worked across business (Today)</p><p>Well Done '+firstName[0]+'!</p><span><i class="fas fa-briefcase"></i></span></div></div>'

                              }
                              if(job == 'revenue'){
                                  award='<div class="col-4 col-md-4 awards-boxes"><div class="h-100 award-box shadow" ><p>'+operator['name']+'</p><p>Most revenue across business (Today) Most % to Target</p><p>Well Done '+firstName[0]+'!</p><span style="padding: 3px 23px;"><i class="fas fa-pound-sign"></i></span></div></div>'

                              }
                              if(job == 'arrangements'){
                                  award='<div class="col-4 col-md-4 awards-boxes"><div class="h-100 award-box shadow" ><p>'+operator['name']+'</p><p>Most payment arrangement across business (Today)</p><p>Well Done '+firstName[0]+'!</p><span style="padding: 3px 11px;"><i class="fas fa-handshake"></i></span></div></div>'

                              }


                              if(sector == 'Legal'){
                                  $('.legal').append(award);
                                  award='';

                              }
                              if(sector == 'Collections'){
                                  $('.collections').append(award);
                                  award='';

                              }
                              if(sector == 'White Label'){
                                  $('.WL').append(award);
                                  award='';

                              }
                          })
      				})
                  }
                });
}


</script>
